<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started with jointVIP • jointVIP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with jointVIP">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jointVIP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/jointVIP.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/additional_options.html">Additional options available in the `jointVIP` package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ldliao/jointVIP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get started with jointVIP</h1>
                        <h4 data-toc-skip class="author">Lauren D.
Liao</h4>
            
            <h4 data-toc-skip class="date">2024-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ldliao/jointVIP/blob/main/vignettes/jointVIP.Rmd" class="external-link"><code>vignettes/jointVIP.Rmd</code></a></small>
      <div class="d-none name"><code>jointVIP.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"jointVIP"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-purpose-of-the-jointvip">The purpose of the jointVIP<a class="anchor" aria-label="anchor" href="#the-purpose-of-the-jointvip"></a>
</h2>
<p>The joint variable importance plot (jointVIP for short) is designed
to help identify which variables to prioritize based on both treatment
and outcome for adjustment. This plot should be used during the design
stage of the observational study prior to the analysis phase.</p>
<p>Traditionally, balance tables and Love plots are used to show
standardized mean differences and identify variables with high treatment
imbalance. However, adjusting <em>only</em> based on treatment imbalance
is not advised since they may not be confounders. The jointVIP helps
researchers prioritize variables that contribute marginal bias on both
dimensions that can be used in observational study design. Additionally,
bias curves based on simple one variable (unadjusted) omitted variable
bias framework are plotted for the ease of comparison.</p>
</div>
<div class="section level2">
<h2 id="set-up-for-example">Set up for example<a class="anchor" aria-label="anchor" href="#set-up-for-example"></a>
</h2>
<p>You can install the released version of jointVIP with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install once its on CRAN!</span></span>
<span><span class="co"># install.packages("jointVIP")</span></span>
<span></span>
<span><span class="co"># devtools::install_github("ldliao/jointVIP")</span></span>
<span></span>
<span><span class="co"># load jointVIP package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ldliao/jointVIP" class="external-link">jointVIP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># data to use for example</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NickCH-K/causaldata" class="external-link">causaldata</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># matching method shown in example</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kosukeimai.github.io/MatchIt/" class="external-link">MatchIt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://optmat.ch" class="external-link">optmatch</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># weighting method shown in example</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ngreifer.github.io/WeightIt/" class="external-link">WeightIt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">optweight</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-cleaning">Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>The example data uses data from the <strong>causaldata</strong>
package, specifically the <code>cps_mixtape</code> and
<code>nsw_mixtape</code> datasets <span class="citation">(Huntington-Klein and Barrett 2021)</span>. The
experimental version of the <code>nsw_mixtape</code> is commonly known
as <code>lalonde</code> and often an example that shows propensity score
matching, with propensity score estimated from the
<code>cps_mixtape</code> data <span class="citation">(Dehejia and Wahba
1999; LaLonde 1986)</span>.</p>
<p>Data set contains the following variables:</p>
<ul>
<li>
<code>treat</code> denoting whether the person was selected in the
National Supported Work Demonstration job-training program</li>
<li>
<code>age</code> age in years</li>
<li>
<code>educ</code> years of education</li>
<li>
<code>black</code> whether the race of the person was Black</li>
<li>
<code>hisp</code> whether the ethnicity of the person was
Hispanic</li>
<li>
<code>marr</code> whether the person was married</li>
<li>
<code>nodegree</code> whether the person has degree or not</li>
<li>
<code>re74</code> real earnings in 1974</li>
<li>
<code>re75</code> real earnings in 1975</li>
<li>
<code>re78</code> outcome of interest: real earnings in 1978</li>
</ul>
<p>Here simple data cleaning is performed to log-transform the earnings.
To avoid errors, those who earned 0 is transformed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">log(1) = 0</annotation></semantics></math>.
After transformation, the both data has new variables:</p>
<ul>
<li>
<code>log_re74</code> log-real earnings in 1974</li>
<li>
<code>log_re75</code> log-real earnings in 1975</li>
<li>
<code>log_re78</code> outcome of interest: log-real earnings in
1978</li>
</ul>
<p>The <code>jointVIP</code> package uses <code>pilot_df</code> and
<code>analysis_df</code> to denote datasets used. The
<code>analysis_df</code> is the matching/weighting dataset of interest
while <code>pilot_df</code> contains the external controls not used in
the analysis. The <code>pilot_df</code> is used to help inform the
outcome correlation and compare the cross-sample standardized mean
difference. If external data is not available, one may choose to
sacrifice a portion of the analysis controls to form the
<code>pilot_df</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data for estimating earnings from 1978</span></span>
<span><span class="co"># treatment is the NSW program</span></span>
<span><span class="va">pilot_df</span> <span class="op">=</span> <span class="va">cps_mixtape</span></span>
<span><span class="va">analysis_df</span> <span class="op">=</span> <span class="va">nsw_mixtape</span></span>
<span></span>
<span><span class="va">transform_earn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">variables</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">log_variables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">variables</span>, </span>
<span>                         <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'log_'</span>,<span class="va">s</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="va">log_variables</span><span class="op">]</span> <span class="op">=</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="va">variables</span><span class="op">]</span>, <span class="fl">2</span>, </span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pilot_df</span> <span class="op">&lt;-</span> <span class="va">cps_mixtape</span></span>
<span><span class="va">pilot_df</span> <span class="op">&lt;-</span> <span class="fu">transform_earn</span><span class="op">(</span><span class="va">pilot_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'re74'</span>, <span class="st">'re75'</span>, <span class="st">'re78'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">analysis_df</span> <span class="op">&lt;-</span> <span class="va">nsw_mixtape</span></span>
<span><span class="va">analysis_df</span> <span class="op">&lt;-</span> <span class="fu">transform_earn</span><span class="op">(</span><span class="va">analysis_df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'re74'</span>, <span class="st">'re75'</span>, <span class="st">'re78'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="specifying-parameters-for-the-create_jointvip-function">Specifying parameters for the <code>create_jointVIP()</code>
function<a class="anchor" aria-label="anchor" href="#specifying-parameters-for-the-create_jointvip-function"></a>
</h2>
<p>To visualize for the jointVIP, following parameters must be
specified:</p>
<ul>
<li>
<code>treatment</code> the treatment variable name; 0 for control
and 1 for treated</li>
<li>
<code>outcome</code> the outcome of interest</li>
<li>
<code>covariates</code> covariates of interest that are common for
the two <code>pilot_df</code> and <code>analysis_df</code> — the
variables all should occur prior to treatment and be potential
confounders</li>
<li>
<code>pilot_df</code> pilot dataset consists of external
controls</li>
<li>
<code>analysis_df</code> analysis dataset consists of both treated
and controls of interest</li>
</ul>
<p>The <code>new_jointVIP</code> is a <code>jointVIP</code> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment</span> <span class="op">=</span> <span class="st">'treat'</span></span>
<span><span class="va">outcome</span> <span class="op">=</span> <span class="st">'log_re78'</span></span>
<span><span class="va">covariates</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">analysis_df</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">analysis_df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment</span>,</span>
<span>                                           <span class="va">outcome</span>, <span class="st">"data_id"</span>,</span>
<span>                                           <span class="st">"re74"</span>, <span class="st">"re75"</span>,</span>
<span>                                           <span class="st">"re78"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_jointVIP</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_jointVIP.html">create_jointVIP</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="va">treatment</span>,</span>
<span>                               outcome <span class="op">=</span> <span class="va">outcome</span>,</span>
<span>                               covariates <span class="op">=</span> <span class="va">covariates</span>,</span>
<span>                               pilot_df <span class="op">=</span> <span class="va">pilot_df</span>,</span>
<span>                               analysis_df <span class="op">=</span> <span class="va">analysis_df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="diagnostics-with-a-jointvip-object">Diagnostics with a <code>jointVIP</code> object<a class="anchor" aria-label="anchor" href="#diagnostics-with-a-jointvip-object"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function outputs the maximum absolute
bias, the number of variables are above the desired bias tolerance
(measured in absolute always), and the number of variables that can be
plotted.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">new_jointVIP</span>, </span>
<span>        smd <span class="op">=</span> <span class="st">"cross-sample"</span>,</span>
<span>        use_abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        bias_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max absolute bias is 0.113</span></span>
<span><span class="co">#&gt; 2 variables are above the desired 0.01 absolute bias tolerance</span></span>
<span><span class="co">#&gt; 8 variables can be plotted</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function outputs the variables and its
associated bias above the absolute <code>bias_tol</code> desired.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">new_jointVIP</span>,</span>
<span>      smd <span class="op">=</span> <span class="st">"cross-sample"</span>,</span>
<span>      use_abs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      bias_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="co">#&gt;           bias</span></span>
<span><span class="co">#&gt; log_re75 0.113</span></span>
<span><span class="co">#&gt; log_re74 0.045</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">new_jointVIP</span><span class="op">)</span></span></code></pre></div>
<p><img src="jointVIP_files/figure-html/plot-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>By visualizing with the <code>jointVIP</code>, several important
aspects stand out. First, the most important variables are the
<code>log_re75</code> and <code>log_re74</code>. Traditional methods,
such as the Love plot or balance table would indicate
<code>nodegree</code> and <code>hisp</code> variables to be more
important to adjust than <code>log_re74</code>, but these variables show
low marginal bias contribution using the jointVIP.</p>
</div>
<div class="section level2">
<h2 id="matching-examples">Matching examples<a class="anchor" aria-label="anchor" href="#matching-examples"></a>
</h2>
<p>Following matching examples are performed to illustrate the utility
of the jointVIP. Based on the plot shown above, the only variables that
need adjustment are the <code>log_re75</code> and <code>log_re74</code>.
Post-match results are plotted to help visualize for comparison.</p>
<div class="section level3">
<h3 id="optimal-pair-matching">Optimal pair matching<a class="anchor" aria-label="anchor" href="#optimal-pair-matching"></a>
</h3>
<p>As a simple example, optimal pair matching using Mahalanobis distance
is used <span class="citation">(Ho et al. 2011; Hansen 2007)</span>.
Based on the desired bias tolerance, only <code>log_re75</code> and
<code>log_re74</code> are inputted into the formula.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1:1 optimal matching w/o replacement</span></span>
<span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html" class="external-link">matchit</a></span><span class="op">(</span></span>
<span>  <span class="va">treat</span> <span class="op">~</span> <span class="va">log_re75</span> <span class="op">+</span> <span class="va">log_re74</span>,</span>
<span>  data <span class="op">=</span> <span class="va">analysis_df</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"optimal"</span>,</span>
<span>  distance <span class="op">=</span> <span class="st">"mahalanobis"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">optmatch_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html" class="external-link">match.data</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">outcome</span>, <span class="va">covariates</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="optimal-weighting">Optimal weighting<a class="anchor" aria-label="anchor" href="#optimal-weighting"></a>
</h3>
<p>Optimal weighting example is performed below, basing the weights upon
<code>log_re75</code> and <code>log_re74</code> <span class="citation">(Greifer 2021)</span>. Please see documentation on
<span class="citation">Zubizarreta (2015)</span> for details.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ordering for the weightit</span></span>
<span><span class="va">ordered_analysis_df</span> <span class="op">=</span> <span class="va">analysis_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">analysis_df</span><span class="op">$</span><span class="va">treat</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">optwt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ngreifer.github.io/WeightIt/reference/weightit.html" class="external-link">weightit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">log_re74</span> <span class="op">+</span> <span class="va">log_re75</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">ordered_analysis_df</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"optweight"</span>, estimand <span class="op">=</span> <span class="st">"ATE"</span>,</span>
<span>                  tols <span class="op">=</span> <span class="fl">0.005</span>, include.obj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># summary(optwt)</span></span>
<span></span>
<span><span class="va">optwt_df</span> <span class="op">=</span> <span class="va">ordered_analysis_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">covariates</span>, <span class="va">treatment</span>, <span class="va">outcome</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-matchingweighting-assessment-with-post_jointvip-object">Post-matching/weighting assessment with <code>post_jointVIP</code>
object<a class="anchor" aria-label="anchor" href="#post-matchingweighting-assessment-with-post_jointvip-object"></a>
</h2>
<p>Below are the examples showing how to plot after matching. The main
function to use is the <strong>create_post_jointVIP()</strong> function,
which takes in the original jointVIP object <code>new_jointVIP</code> in
our example. The post-matched data frame need to be specified as
<code>post_analysis_df</code> argument.</p>
<p>The functions: <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, and
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> all provide comparison between original and post
jointVIPs. Note that the post-matched data frames contain the
pair-matched individuals — for post-weighted data, an additional
processing step multiplying the weight by the original data.frame
subsetted on all the covariates.</p>
<p>All methods yielded satisfactory results based on desired bias
tolerance.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_optmatch_jointVIP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_post_jointVIP.html">create_post_jointVIP</a></span><span class="op">(</span><span class="va">new_jointVIP</span>, </span>
<span>                                               post_analysis_df <span class="op">=</span> <span class="va">optmatch_df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post_optmatch_jointVIP</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max absolute bias is 0.113</span></span>
<span><span class="co">#&gt; 2 variables are above the desired 0.01 absolute bias tolerance</span></span>
<span><span class="co">#&gt; 8 variables can be plotted</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Max absolute post-bias is 0.005</span></span>
<span><span class="co">#&gt; Post-measure has 0 variable(s) above the desired 0.005 absolute bias tolerance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">post_optmatch_jointVIP</span><span class="op">)</span></span>
<span><span class="co">#&gt;           bias post_bias</span></span>
<span><span class="co">#&gt; log_re75 0.113     0.005</span></span>
<span><span class="co">#&gt; log_re74 0.045     0.003</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post_optmatch_jointVIP</span>, </span>
<span>     plot_title <span class="op">=</span> <span class="st">"Post-match jointVIP using optimal matching"</span><span class="op">)</span></span></code></pre></div>
<p><img src="jointVIP_files/figure-html/post_opt-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_optwt_jointVIP</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_post_jointVIP.html">create_post_jointVIP</a></span><span class="op">(</span><span class="va">new_jointVIP</span>,</span>
<span>                                           post_analysis_df <span class="op">=</span> <span class="va">optwt_df</span>,</span>
<span>                                           wts <span class="op">=</span> <span class="va">optwt</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post_optwt_jointVIP</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max absolute bias is 0.113</span></span>
<span><span class="co">#&gt; 2 variables are above the desired 0.01 absolute bias tolerance</span></span>
<span><span class="co">#&gt; 8 variables can be plotted</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Max absolute post-bias is 0.005</span></span>
<span><span class="co">#&gt; Post-measure has 0 variable(s) above the desired 0.005 absolute bias tolerance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">post_optwt_jointVIP</span><span class="op">)</span></span>
<span><span class="co">#&gt;           bias post_bias</span></span>
<span><span class="co">#&gt; log_re75 0.113     0.003</span></span>
<span><span class="co">#&gt; log_re74 0.045     0.003</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post_optwt_jointVIP</span>, </span>
<span>     plot_title <span class="op">=</span> <span class="st">"Post-weighting jointVIP using optimal weighting"</span><span class="op">)</span></span></code></pre></div>
<p><img src="jointVIP_files/figure-html/post_wt-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dehejia1999causal" class="csl-entry">
Dehejia, Rajeev H, and Sadek Wahba. 1999. <span>“Causal Effects in
Nonexperimental Studies: Reevaluating the Evaluation of Training
Programs.”</span> <em>Journal of the American Statistical
Association</em> 94 (448): 1053–62.
</div>
<div id="ref-weightit" class="csl-entry">
Greifer, Noah. 2021. <em>WeightIt: Weighting for Covariate Balance in
Observational Studies</em>. <a href="https://CRAN.R-project.org/package=WeightIt" class="external-link">https://CRAN.R-project.org/package=WeightIt</a>.
</div>
<div id="ref-hansen2007optmatch" class="csl-entry">
Hansen, Ben B. 2007. <span>“Optmatch: Flexible, Optimal Matching for
Observational Studies.”</span> <em>New Functions for Multivariate
Analysis</em> 7 (2): 18–24.
</div>
<div id="ref-matchit" class="csl-entry">
Ho, Daniel E., Kosuke Imai, Gary King, and Elizabeth A. Stuart. 2011.
<span>“<span>MatchIt</span>: Nonparametric Preprocessing for Parametric
Causal Inference.”</span> <em>Journal of Statistical Software</em> 42
(8): 1–28. <a href="https://www.jstatsoft.org/v42/i08/" class="external-link">https://www.jstatsoft.org/v42/i08/</a>.
</div>
<div id="ref-causaldata" class="csl-entry">
Huntington-Klein, Nick, and Malcolm Barrett. 2021. <em>Causaldata:
Example Data Sets for Causal Inference Textbooks</em>. <a href="https://CRAN.R-project.org/package=causaldata" class="external-link">https://CRAN.R-project.org/package=causaldata</a>.
</div>
<div id="ref-lalonde1986evaluating" class="csl-entry">
LaLonde, Robert J. 1986. <span>“Evaluating the Econometric Evaluations
of Training Programs with Experimental Data.”</span> <em>The American
Economic Review</em>, 604–20.
</div>
<div id="ref-zubizarreta2015stable" class="csl-entry">
Zubizarreta, José R. 2015. <span>“Stable Weights That Balance Covariates
for Estimation with Incomplete Outcome Data.”</span> <em>Journal of the
American Statistical Association</em> 110 (511): 910–22.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lauren D. Liao, Samuel D. Pimentel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
